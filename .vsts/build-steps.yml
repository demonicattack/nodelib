steps:
  - task: NodeTool@0
    inputs:
      versionSpec: '${{parameters.node_version}}'

  - script: node --version && npm --version
    displayName: Environment information

  - task: Npm@0
    displayName: Install dependencies
    inputs:
      command: install

  - script: ./node_modules/.bin/lerna bootstrap
    displayName: Link packages

  - script: ./node_modules/.bin/lerna run compile
    displayName: Compile Sources

  - script: ./node_modules/.bin/lerna run --parallel lint
    displayName: Run Hygiene Checks

  - script: npm run lint:dependencies
    displayName: Run Dependencies Checks

  - script: ./node_modules/.bin/lerna run --parallel test
    displayName: Run Unit Tests
